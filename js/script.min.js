function changeTheme(e){var t=e||$("#themeSelection")[0].value;var n=document.createElement("link");n.setAttribute("rel","stylesheet");n.setAttribute("type","text/css");n.setAttribute("href","css/themes/"+t+"/"+t+".css");document.getElementsByTagName("head")[0].appendChild(n);localStorage.setItem("chosenTheme",t)}function sampleData(){document.getElementById("timeInput").value="";var e="";for(var t=0;t<150;t++){var n=(Math.random()*20+10).toFixed(2);e+=n.toString()+", "}e=e.substring(0,e.length-2);document.getElementById("timeInput").value=e}function getTimeArr(){timeArr=$("#timeInput").val().replace(/\s+/g,"").split(",").map(function(e){if(/dnf/ig.test(e))return"DNF";else if(/(\d{1,2}:)?\d{1,2}(.\d{1,2})?\+2?/.test(e)){if(/\d{1,2}:\d{1,2}.\d{1,2}/.test(e)){var t=e.replace(/\+2?/,"");return minToSec(e)+"+2"}else{return e}}else if(/\d{1,2}:\d{1,2}.\d{1,2}/.test(e))return parseFloat(minToSec(e));else{return parseFloat(e)}});if(isNaN(timeArr[timeArr.length-1])&&typeof timeArr[timeArr.length-1]!="string")timeArr.pop()}function minToSec(e){if(/(\d{1,2}:){2}(\d{1,2}.)(\d{1,2})/.test(e)){var t=e.split(":"),n=+t[0],r=+t[1],i=+t[2];return(n*3600+r*60+i).toFixed(2)}else{var t=e.split(":"),r=+t[0],i=+t[1];return(r*60+i).toFixed(2)}}function formatTime(e){var t=Math.floor(e/3600);var n=Math.floor((e-t*3600)/60);var e=(e-t*3600-n*60).toFixed(2);var r="";if(t>0)r+=t.toString()+"h, ";if(n>0)r+=n.toString()+"m ";if(n>0)r+="and ";r+=e.toString()+"s";return r}function updateStats(){$("#stats_numSolves").text(getNumSolves().toString());$("#stats_bestTime").text(getBestTime().toString());$("#stats_worstTime").text(getWorstTime().toString());$("#stats_numDNF").text(getNumDNF().toString());$("#stats_numPlusTwo").text(getNumberPlusTwo().toString());$("#stats_avgTotal").text(getTotalAverage().toString());$("#stats_meanTotal").text(getTotalMean().toString());$("#stats_medianTotal").text(getTotalMedian().toString());$("#stats_varianceTotal").text(getTotalVariance().toString());$("#stats_standardDeviation").text(getTotalStandardDeviation().toString());$("#stats_totalTime").text(getTotalTime());$("#stats_avg3Best").text(getAverage(3,true));$("#stats_avg3Worst").text(getAverage(3,false));$("#stats_avg5Best").text(getAverage(5,true));$("#stats_avg5Worst").text(getAverage(5,false));$("#stats_avg12Best").text(getAverage(12,true));$("#stats_avg12Worst").text(getAverage(12,false));$("#stats_avg100Best").text(getAverage(100,true));$("#stats_avg100Worst").text(getAverage(100,false))}function getNumSolves(){return timeArr.length}function getBestTime(e){var t=timeArr.getTimeArr(true);if(t.length==0)return formatTime(0);var n=Math.min.apply(null,t);return e?n:formatTime(n)}function getWorstTime(){var e=timeArr.getTimeArr(true);if(e.length==0)return formatTime(0);return formatTime(Math.max.apply(null,e))}function getNumDNF(){var e=0;timeArr.map(function(t){if(t=="DNF")e++});return e}function getNumberPlusTwo(){var e=0;timeArr.map(function(t){if(/(\d{1,2}:)?\d{1,2}(.\d{1,2})?\+2?/.test(t))e++});return e}function getTotalTime(){var e=timeArr.getTimeArr();if(e.length==0)return formatTime(0);var t=e.reduce(function(e,t){return e+t});return formatTime(t)}function getTotalMean(){var e=timeArr.getTimeArr();if(e.length==0||isNaN(e[0]))return formatTime(0);var t=e.reduce(function(e,t){return e+t});return formatTime((t/e.length).toFixed(2))}function getTotalAverage(){var e=timeArr.getTimeArr();var t=e.length/100*5;if(e.length<=2)return formatTime(0);for(var n=0;n<t;n++){var r=Math.max.apply(null,e);var i=e.indexOf(r);e.splice(i,1);var s=Math.min.apply(null,e);var o=e.indexOf(s);e.splice(o,1)}var u=e.reduce(function(e,t){return e+t});var a=(u/e.length).toFixed(2);return formatTime(a)}function getTotalMedian(){var e=timeArr.getTimeArr();var t=e.length;e.sort(function(e,t){return e-t});medianArr=[];if(t%2==0&&t>0){medianArr=e.slice(Math.floor(t/2)-1,Math.ceil(t/2)+1)}else{medianArr.push(e[Math.ceil(t/2)-1])}var n=medianArr.length==2?medianArr.reduce(function(e,t){return e+t})/2:medianArr[0];return formatTime(n)}function getTotalVariance(){var e=timeArr.getTimeArr();if(e.length==0||isNaN(e[0]))return formatTime(0);var t=e.reduce(function(e,t){return e+t})/e.length;var n=0;for(var r=0;r<=e.length-1;r++){n+=Math.pow(e[r]-t,2)}var i=n/e.length;return formatTime(i)}function getTotalStandardDeviation(){var e=timeArr.getTimeArr();if(e.length==0||isNaN(e[0]))return formatTime(0);var t=e.reduce(function(e,t){return e+t})/e.length;var n=0;for(var r=0;r<=e.length-1;r++){n+=Math.pow(e[r]-t,2)}var i=n/e.length;var s=Math.sqrt(i);return formatTime(s)}function getAverage(e,t){getTimeArr();var n=timeArr.getTimeArr();var r=0;var i;n=n.map(function(e){return parseFloat(e)});for(var s=0;s<n.length-e+1;s++){var o=new Array;var u=Math.ceil(e/100*5);for(var a=0;a<e;a++){o.push(n[s+a])}for(var f=0;f<u;f++){var l=Math.max.apply(null,o);var c=o.indexOf(l);o.splice(c,1);var h=Math.min.apply(null,o);var p=o.indexOf(h);o.splice(p,1)}var d=o.reduce(function(e,t){return e+t})/o.length;if(s==0||d<i)i=parseFloat(d.toFixed(2));if(d>r)r=parseFloat(d.toFixed(2))}return formatTime(t?i:r)}function displayGraph(e){getTimeArr();updateStats();if(e){e.preventDefault()}rangeSelection(timeArr,function(e){timeArr=e.split(",");generateGraph(timeArr)})}function generateGraph(e){var t=e.map(function(e){var t=e.toString();if(t=="DNF")return 0;else if(/(\d{1,2}:)?\d{1,2}(.\d{1,2})?\+2?/.test(t)){var n=t.replace("+2","");if(/(\d{1,2}:){1,2}(\d{1,2}.)(\d{1,2})/.test(n))return parseFloat(minToSec(n),10)+2;else{return parseFloat(n,10)+2}}return parseFloat(e,10)});t=t.filter(function(e){if(e!=0)return true});var n={min:Math.min.apply(null,t.getTimeArr()),max:Math.max.apply(null,t.getTimeArr())};switch($("#chartSelection")[0].value){case"linechart":e=markPoints(t,n);createLineGraph(e);break;case"scatterplot":e=markPoints(t,n);createScatterPlot(e);break;case"barchart":createBarChart(t);break;default:createLineGraph(t,n);break}chart=$("#chartContainer").highcharts()}function markPoints(e,t){var n="";var r="";for(var i=0;i<e.length;i++){if(e[i]==t.min){e[i]={marker:{fillColor:"#2ecc71",lineWidth:10,lineColor:"#27ae60"},y:e[i]}}else if(e[i]==t.max){e[i]={marker:{fillColor:"#e74c3c",lineWidth:10,lineColor:"#c0392b"},y:e[i]}}}return e}function toggleFullscreen(){if(!fullscreen){chartHeight=chart.chartHeight;chart.setSize($(window).width(),$(window).height(),false);$("#chartContainer").css("position","absolute").css("top","0px").css("margin","0").css("padding","0");$(".highcharts-container").css("margin","0%");$(".highcharts-container svg").css("margin","0%");fullscreen=true}else if(fullscreen){chart.setSize($(document).width()/100*60,chartHeight,false);$("#chartContainer").css("position","").css("top","").css("margin","").css("padding","0px 15px");$(".highcharts-container").css("margin","1.5% auto");$(".highcharts-container svg").css("margin","");fullscreen=false}}function setDefaultOptions(){Highcharts.setOptions({chart:{renderTo:"chartContainer",style:{fontFamily:"OpenSans_Regular",margin:"1.5% auto",overflow:"auto !important"},width:$(document).width()/100*60,backgroundColor:"#1A222F",spacing:[30,20,20,20]},colors:["#00CF99","#B2E097"],title:{text:""},tooltip:{valueSuffix:" Seconds"},subtitle:{text:"Double-Click for Fullscreen"},legend:{enabled:false},credits:{enabled:false}})}function rangeSelection(e,t){function u(){for(var r=0;r<e.length-i+1;r++){var u=new Array;for(var a=0;a<i;a++){if(e[r+a]!="DNF"){if(/\d{1,}.\d{1,}\+2?/.test(e[r+a])){u.push(parseFloat(e[r+a])+2)}else{u.push(e[r+a])}}}o++;for(var f=0;f<s;f++){var l=Math.max.apply(null,u);var c=u.indexOf(l);u.splice(c,1);var h=Math.min.apply(null,u);var p=u.indexOf(h);u.splice(p,1)}n.push((u.reduce(function(e,t){return e+t})/u.length).toFixed(2))}t(n.toString())}var n=[];var r=$("#rangeSelection")[0].value;var i=parseInt(r.replace("avg",""),10);var s=Math.ceil(i/100*5);var o=0;if(r!="single"){u()}else if(r=="single"){t(e.toString())}}function createLineGraph(e){new Highcharts.Chart({chart:{type:"line"},yAxis:{title:{text:"Times"}},xAxis:{title:{text:"Solve (Nr.)"}},series:[{name:"Time",data:e}]})}function createScatterPlot(e){new Highcharts.Chart({chart:{type:"scatter"},xAxis:{title:{text:"SolveNr"}},yAxis:{title:{text:"Time"}},series:[{name:"Time",data:e}]})}function createBarChart(e){var t=Math.max.apply(null,e);var n=Math.min.apply(null,e);var r=Math.round(t-n);var i=Math.pow(10,r.toString().length-1);var s=Math.ceil(r/i)*i;var o=Math.floor(n/i)*i;var u=Math.ceil(t/i)*i;var a=e.length;var f=[];var l=[];for(var c=0;c<=5;c++){var h=o+s/5*c;if(h%1!=0)h=h.toFixed(2);f.push(h)}for(var c=0;c<5;c++){var p=f[c].toString()+" - "+f[c+1].toString();l[c]=p}timeData=[];for(var c=0;c<5;c++){var d=l[c];var v=0;for(index in e){var m=e[index];if(m>=f[c]&&m<f[c+1]||m==f[c])v++}timeData.push([d,v]);v=0}new Highcharts.Chart({chart:{type:"column"},tooltip:{valueSuffix:""},xAxis:{title:{text:"Time Range"},type:"category"},yAxis:{title:{text:"Number of solves in range"}},series:[{name:"Number of times in range",data:timeData}]})}var chart;var chartHeight;var fullscreen=false;var timeArr=[];Array.prototype.getTimeArr=function(){var e=[];for(var t=0;t<this.length;t++){if(this[t]!=0&&this[t]!="DNF"&&!/(\d{1,2}:)?\d{1,2}(.\d{1,2})?\+2?/.test(this[t])){e.push(this[t])}else if(/\d{1,}.\d{1,}\+2?/.test(this[t])){e.push(parseFloat(this[t].replace(/\+2?/,""),10)+2)}}return e};$(document).ready(function(){var e="soulless";var t=localStorage.getItem("chosenTheme");if(t==null){changeTheme(e);$("#themeSelection").val(e)}else{changeTheme(t);$("#themeSelection").val(t)}getTimeArr();updateStats();$("[data-toggle='tooltip']").tooltip({placement:"left",delay:{show:400,hide:50}});setDefaultOptions();$("#graphBtn").click(displayGraph);$("#sampleDataBtn").click(sampleData);$("#chartContainer").dblclick(toggleFullscreen);$("#statTabLink").click(function(){getTimeArr();updateStats()});$("#timeInput").on("change keydown paste mouseup",function(){setTimeout(function(){getTimeArr();updateStats()},5)});$("#themeSelection").fancySelect();$("#chartSelection").fancySelect();$("#rangeSelection").fancySelect()})